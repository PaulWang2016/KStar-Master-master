@{
    ViewBag.Title = "_ControlTemplateView";    
}

<div class="panel panel-default" style="margin-top:10px;">
    <div class="panel-heading">
        <h3 class="panel-title">CategoryTemplate
        </h3>
    </div>
    <div class="panel-body" style="min-width:650px;">
        <div class="panel panel-default">
            <div class="panel-heading">
                <div class="btn-group">
                    <button id="AddCategoryTemplate" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-plus">新增</span>
                    </button>
                    <button id="EditCategoryTemplate" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-plus">编辑</span>
                    </button>
                    <button id="DeleteCategoryTemplate" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-plus">删除</span>
                    </button>
                    <button id="ClearSelect" type="button" class="btn btn-default">
                        <span class="glyphicon glyphicon-plus">清空选择</span>
                    </button>
                </div>
            </div>
            <div class="panel-body">
                <div class="row navbar navbar-default" style="margin: 0 5px 0 5px;">
                    <div class="col-md-4" style="border-right: 1px solid #CCC9C9; margin-right:-1px;">
                        <ul id="categorytemplategrid" class="ztree" url="@Url.Content("~/Maintenance/CategoryTemplate/GetCategoryTree")"  Singleurl="@Url.Content("~/Maintenance/CategoryTemplate/GetCategoryTemplateById")" style="margin-bottom:0px;"></ul>
                    </div>                    
                    <div class="col-md-8" style="border-left: 1px solid #CCC9C9;">
                        <div class="panel panel-default" style="margin-top:5px;">
                            <div class="panel-heading" style="padding:0px;">
                                <div class="btn-group">
                                    <button id="AddControlTemplate" type="button" class="btn btn-default">
                                        <span class="glyphicon glyphicon-plus">新增</span>
                                    </button>
                                </div>
                            </div>
                            <div class="panel-body">
                                <table id="controltemplategrid" class="table table-condensed table-hover table-striped" selectCategory="" selectCategoryType=""  url="@Url.Content("~/Maintenance/CategoryTemplate/GetControlTemplate")"  Singleurl="@Url.Content("~/Maintenance/CategoryTemplate/GetControlTemplateById")" style="margin-bottom:0px;">
                                    <thead>
                                        <tr>
                                            <th data-column-id="DisplayName">DisplayName</th>
                                           @* <th data-column-id="HtmlTemplate" data-formatter="Html">HtmlTemplate</th>*@
                                            <th data-column-id="CategoryName">CategoryName</th>
                                            <th data-column-id="Options" data-formatter="Options" data-sortable="false">Options</th>
                                        </tr>
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 新增修改 -->
<div class="modal fade bootdialog" id="CategoryTemplateWindow" url="@Url.Content("~/Maintenance/CategoryTemplate/")" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="CategoryTemplateWindow" style="width: 700px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                    data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">CategoryTemplates
                </h4>
            </div>
            <div class="modal-body">
                <form id="_kstarform_categorytemplate_form" class="form-horizontal">

                    <div class="form-group ">
                        <label class="control-label col-sm-2">CategoryName:</label>
                        <div class="col-sm-10">
                            <input type="text"
                                data-rule-required="true"
                                data-msg-required="请输入CategoryName！"
                                class="form-control" placeholder="请填写CategoryName" data-bind="value: CategoryName" />
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">
                    关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
                <input type="reset" id="_kstarform_categorytemplate_form_reset" style="display: none;" />
            </div>
        </div>
    </div>
</div>
<!-- 新增修改 -->

<!--确认-->
<div class="modal fade bootdialog" id="ConfirmWindow" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" style="width: 700px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                    data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title">确认提示
                </h4>
            </div>
            <div class="modal-body">
                是否确认删除此分类?          
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">
                    关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
            </div>
        </div>
    </div>
</div>
<!--确认框-->

<!-- 新增修改 -->
<div class="modal fade bootdialog" id="ControlTemplateWindow" url="@Url.Content("~/Maintenance/CategoryTemplate/")" tabindex="-1" role="dialog"
    aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="ControlTemplateWindow" style="width: 700px">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close"
                    data-dismiss="modal" aria-hidden="true">
                    &times;
                </button>
                <h4 class="modal-title" id="myModalLabel">ControlTemplates
                </h4>
            </div>
            <div class="modal-body">
                <form id="_kstarform_controltemplate_form" class="form-horizontal">

                    <div class="form-group ">
                        <label class="control-label col-sm-2">DisplayName:</label>
                        <div class="col-sm-10">
                            <input id="DisplayName" type="text"
                                data-rule-required="true"
                                data-msg-required="请输入DisplayName！"
                                class="form-control" placeholder="请填写DisplayName" />
                        </div>
                    </div>

                    <div class="form-group  ">
                        <label class="col-sm-2 control-label">CategoryId:</label>
                        <div class="col-sm-10">
                            <input id="CategoryId" type="text" readonly data-rule-required="true"
                                data-msg-required="请选择分类！" class="form-control" placeholder="请选择分类" />
                        </div>
                    </div>
                    <div class="form-group  ">
                        <label class="control-label col-sm-2">HtmlTemplate:</label>
                        <div class="col-sm-10">
                            <textarea id="HtmlTemplate" class="form-control" rows="5" data-rule-required="true"
                                data-msg-required="请输入HtmlTemplate！"
                                class="form-control" placeholder="请填写HtmlTemplate"></textarea>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">
                    关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
                <input type="reset" id="_kstarform_controlsetting_form_reset" style="display: none;" />
            </div>
        </div>
    </div>
</div>
<!-- 新增修改 -->

<div id="menuContent" role="dialog" class="menuContent bootdialog" url="@Url.Content("~/Maintenance/CategoryTemplate/GetCategoryTypeTree")" style="display: none; position: absolute; z-index:20051; overflow:auto;background: whitesmoke; height:320px;">
    <ul id="categorytree" class="ztree"></ul>
</div>


@Styles.Render("~/content/jqueryztree")
@Styles.Render("~/content/jquerybootgrid")
@Scripts.Render("~/bundles/knockout")
@Scripts.Render("~/bundles/jqueryval")
@Scripts.Render("~/bundles/kstarform")
@Scripts.Render("~/bundles/jqueryztree")
@Scripts.Render("~/bundles/jquerybootgrid")

<script src="@Url.Content("~/JS/Maintenance/_Sea_CategoryTemplate.js")" type="text/javascript"></script>
<script src="@Url.Content("~/JS/Maintenance/_Sea_ControlTemplate.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(function () {
        CategoryTemplateWindow.initGrid();
        CategoryTemplateWindow.initButtons();

        ControlTemplateWindow.initGrid();
        ControlTemplateWindow.initButtons();
    });

    function toggleMenu() {
         
        var menuContent = $("#menuContent");
        if (menuContent.css("display") == "block") {
            hideMenu();
        }
        else {
            showMenu();
        }
    }

    function showMenu() {
        var cityObj = $("#CategoryId");
        var cityOffset = $("#CategoryId").offset();
        $("#menuContent").css({ width: "552px", left: cityOffset.left + "px", top: cityOffset.top + cityObj.outerHeight() + "px" }).slideDown("fast");
        $("body").bind("mousedown", onBodyDown);
    }
    function hideMenu() {
        $("#menuContent").fadeOut("fast");
        $("body").unbind("mousedown", onBodyDown);
    }
    function onBodyDown(event) {
        if (!(event.target.id == "menuBtn" || event.target.id == "menuContent" || $(event.target).parents("#menuContent").length > 0)) {
            hideMenu();
        }
    }
</script>

